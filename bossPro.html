<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>掘采三队工资条查询平台</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2c3e50;
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --success-color: #2ecc71;
        }
        
        body {
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 0;
            margin: 0;
            color: #333;
            min-height: 100vh;
        }
        
        .login-container {
            max-width: 400px;
            margin: 100px auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            padding: 30px;
        }
        
        .header {
            background: linear-gradient(135deg, var(--secondary-color), #1a2530);
            color: white;
            padding: 15px 25px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }
        
        .platform-container {
            max-width: 1200px;
            margin: 20px auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .platform-header {
            background: linear-gradient(135deg, #2c3e50, #1a2530);
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        .nav-tabs {
            background-color: var(--light-color);
            padding: 0 20px;
        }
        
        .nav-tabs .nav-link {
            padding: 15px 25px;
            font-weight: 600;
            color: var(--secondary-color);
            border: none;
            border-bottom: 3px solid transparent;
        }
        
        .nav-tabs .nav-link.active {
            color: var(--primary-color);
            background: transparent;
            border-bottom: 3px solid var(--primary-color);
        }
        
        .tab-content {
            padding: 25px;
        }
        
        .welcome-section {
            text-align: center;
            padding: 40px 20px;
            background: white;
            border-radius: 8px;
            margin-bottom: 30px;
        }
        
        .welcome-section i {
            font-size: 64px;
            color: var(--primary-color);
            margin-bottom: 20px;
        }
        
        .salary-card {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
            margin-bottom: 20px;
            overflow: hidden;
        }
        
        .salary-card-header {
            background-color: var(--primary-color);
            color: white;
            padding: 15px 20px;
            font-weight: 600;
        }
        
        .salary-card-body {
            padding: 20px;
        }
        
        .salary-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }
        
        .salary-item:last-child {
            border-bottom: none;
        }
        
        .salary-item .label {
            color: #7f8c8d;
        }
        
        .salary-item .value {
            font-weight: 600;
        }
        
        .total-salary {
            background-color: #fff8e1;
            font-size: 1.2em;
            font-weight: 700;
            color: #e74c3c;
        }
        
        .sheet-container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            margin-bottom: 25px;
        }
        
        .sheet-header {
            background-color: var(--light-color);
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #ddd;
        }
        
        .sheet-tools {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .table-container {
            overflow-x: auto;
        }
        
        .sheet-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .sheet-table th, .sheet-table td {
            border: 1px solid #ddd;
            padding: 10px 12px;
            min-width: 130px;
            position: relative;
        }
        
        .sheet-table th {
            background-color: var(--primary-color);
            color: white;
            font-weight: 600;
            cursor: pointer;
        }
        
        .sheet-table th:hover {
            background-color: #2980b9;
        }
        
        .sheet-table th i {
            margin-left: 5px;
            opacity: 0.7;
        }
        
        .sheet-table tbody tr:hover {
            background-color: #f1f8ff;
        }
        
        .editable-cell {
            outline: none;
            min-height: 20px;
        }
        
        .selected-cell {
            background-color: #d6eaf8;
            border: 2px solid var(--primary-color) !important;
        }
        
        .numeric {
            text-align: right;
        }
        
        .footer {
            margin-top: 30px;
            text-align: center;
            padding: 15px;
            background-color: var(--secondary-color);
            color: white;
            border-radius: 5px;
        }
        
        .search-box {
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
        }
        
        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .stat-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.08);
            text-align: center;
        }
        
        .stat-card h3 {
            margin: 0;
            font-size: 16px;
            color: #7f8c8d;
        }
        
        .stat-card .value {
            font-size: 28px;
            font-weight: bold;
            color: var(--primary-color);
            margin: 10px 0;
        }
        
        .highlight {
            background-color: #fff8e1 !important;
        }
        
        .admin-only {
            display: none;
        }
        
        .role-admin .admin-only {
            display: block;
        }
        
        .role-admin .admin-tab {
            display: inline-block;
        }
        
        .password-management {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.08);
            margin-bottom: 25px;
        }
        
        @media (max-width: 768px) {
            .sheet-tools {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .btn-group {
                margin-bottom: 10px;
            }
            
            .stats-cards {
                grid-template-columns: 1fr;
            }
            
            .search-box {
                flex-direction: column;
            }
            
            .nav-tabs .nav-link {
                padding: 10px 15px;
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <!-- 登录界面 -->
    <div id="loginPage" class="login-container">
        <div class="text-center mb-4">
            <i class="fas fa-money-check-alt fa-3x text-primary"></i>
            <h2 class="mt-2">掘采三队工资条查询平台</h2>
            <p class="text-muted">请输入您的员工编号和密码登录系统</p>
        </div>
        
        <div class="mb-3">
            <label for="employeeId" class="form-label">员工编号</label>
            <input type="text" class="form-control" id="employeeId" placeholder="请输入员工编号">
        </div>
        <div class="mb-3">
            <label for="password" class="form-label">密码</label>
            <input type="password" class="form-control" id="password" placeholder="请输入密码">
        </div>
        <div class="mb-3 form-check">
            <input type="checkbox" class="form-check-input" id="rememberMe">
            <label class="form-check-label" for="rememberMe">记住我</label>
        </div>
        <div class="d-grid gap-2">
            <button class="btn btn-primary" id="loginBtn"><i class="fas fa-sign-in-alt me-2"></i>登录</button>
        </div>
        
        <div class="mt-3 text-center">
            <p class="text-muted">初始密码: <span class="text-primary">123</span></p>
            <p class="text-muted">忘记密码请联系管理员重置</p>
        </div>
    </div>

    <!-- 主平台界面 -->
    <div id="platformPage" class="d-none">
        <div class="header">
            <div class="d-flex justify-content-between align-items-center">
                <h1><i class="fas fa-money-check-alt me-2"></i>掘采三队工资条查询平台</h1>
                <div>
                    <span class="badge bg-light text-dark me-2" id="userRoleBadge">员工</span>
                    <button class="btn btn-outline-light btn-sm" id="userMenu"><i class="fas fa-user me-1"></i><span id="userName">用户</span></button>
                    <button class="btn btn-outline-light btn-sm ms-2" id="logoutBtn"><i class="fas fa-sign-out-alt me-1"></i>退出</button>
                </div>
            </div>
        </div>

        <div class="platform-container">
            <ul class="nav nav-tabs" id="platformTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="query-tab" data-bs-toggle="tab" data-bs-target="#query" type="button" role="tab">工资查询</button>
                </li>
                <li class="nav-item admin-only" role="presentation">
                    <button class="nav-link" id="admin-tab" data-bs-toggle="tab" data-bs-target="#admin" type="button" role="tab">管理后台</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="help-tab" data-bs-toggle="tab" data-bs-target="#help" type="button" role="tab">帮助中心</button>
                </li>
            </ul>
            
            <div class="tab-content" id="platformTabContent">
                <!-- 工资查询标签页 -->
                <div class="tab-pane fade show active" id="query" role="tabpanel">
                    <div class="welcome-section">
                        <i class="fas fa-file-invoice-dollar"></i>
                        <h2>欢迎使用工资条查询系统</h2>
                        <p class="text-muted" id="welcomeMessage">您可以在这里查询您的工资明细和历史记录</p>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="salary-card">
                                <div class="salary-card-header">
                                    2023年10月工资条
                                </div>
                                <div class="salary-card-body">
                                    <div class="salary-item">
                                        <span class="label">员工编号</span>
                                        <span class="value" id="currentEmployeeId">1001</span>
                                    </div>
                                    <div class="salary-item">
                                        <span class="label">姓名</span>
                                        <span class="value" id="currentEmployeeName">张三</span>
                                    </div>
                                    <div class="salary-item">
                                        <span class="label">部门</span>
                                        <span class="value" id="currentEmployeeDept">掘采三队</span>
                                    </div>
                                    <div class="salary-item">
                                        <span class="label">基本工资</span>
                                        <span class="value">¥8,000.00</span>
                                    </div>
                                    <div class="salary-item">
                                        <span class="label">加班工资</span>
                                        <span class="value">¥1,500.00</span>
                                    </div>
                                    <div class="salary-item">
                                        <span class="label">奖金</span>
                                        <span class="value">¥1,000.00</span>
                                    </div>
                                    <div class="salary-item">
                                        <span class="label">扣款</span>
                                        <span class="value">¥200.00</span>
                                    </div>
                                    <div class="salary-item">
                                        <span class="label">个人所得税</span>
                                        <span class="value">¥530.00</span>
                                    </div>
                                    <div class="salary-item total-salary">
                                        <span class="label">实发工资</span>
                                        <span class="value">¥9,770.00</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="salary-card">
                                <div class="salary-card-header">
                                    历史工资记录
                                </div>
                                <div class="salary-card-body">
                                    <div class="list-group">
                                        <a href="#" class="list-group-item list-group-item-action">
                                            <div class="d-flex w-100 justify-content-between">
                                                <h6 class="mb-1">2023年9月工资</h6>
                                                <small>¥9,520.00</small>
                                            </div>
                                            <small class="text-muted">发放日期: 2023-10-08</small>
                                        </a>
                                        <a href="#" class="list-group-item list-group-item-action">
                                            <div class="d-flex w-100 justify-content-between">
                                                <h6 class="mb-1">2023年8月工资</h6>
                                                <small>¥9,850.00</small>
                                            </div>
                                            <small class="text-muted">发放日期: 2023-09-07</small>
                                        </a>
                                        <a href="#" class="list-group-item list-group-item-action">
                                            <div class="d-flex w-100 justify-content-between">
                                                <h6 class="mb-1">2023年7月工资</h6>
                                                <small>¥10,200.00</small>
                                            </div>
                                            <small class="text-muted">发放日期: 2023-08-08</small>
                                        </a>
                                        <a href="#" class="list-group-item list-group-item-action">
                                            <div class="d-flex w-100 justify-content-between">
                                                <h6 class="mb-1">2023年6月工资</h6>
                                                <small>¥9,450.00</small>
                                            </div>
                                            <small class="text-muted">发放日期: 2023-07-07</small>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 管理后台标签页 -->
                <div class="tab-pane fade" id="admin" role="tabpanel">
                    <div class="admin-only">
                        <div class="password-management">
                            <h4><i class="fas fa-key me-2"></i>密码管理</h4>
                            <div class="row mt-3">
                                <div class="col-md-6">
                                    <div class="input-group mb-3">
                                        <input type="text" class="form-control" id="passwordEmployeeId" placeholder="员工编号">
                                        <button class="btn btn-primary" id="searchEmployeeBtn">查找</button>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="input-group mb-3">
                                        <input type="password" class="form-control" id="newPassword" placeholder="新密码">
                                        <button class="btn btn-success" id="changePasswordBtn">修改密码</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="search-box">
                            <input type="text" class="form-control" placeholder="搜索员工姓名、部门或ID...">
                            <button class="btn btn-primary"><i class="fas fa-search me-1"></i>搜索</button>
                            <button class="btn btn-outline-secondary"><i class="fas fa-filter me-1"></i>筛选</button>
                        </div>

                        <div class="stats-cards">
                            <div class="stat-card">
                                <h3>本月工资总额</h3>
                                <div class="value">¥ 256,800</div>
                                <div>较上月 <span class="text-success">+5.2%</span></div>
                            </div>
                            <div class="stat-card">
                                <h3>员工总数</h3>
                                <div class="value">86 人</div>
                                <div>全职: 72 | 兼职: 14</div>
                            </div>
                            <div class="stat-card">
                                <h3>平均工资</h3>
                                <div class="value">¥ 9,580</div>
                                <div>最高: ¥ 15,400 | 最低: ¥ 5,200</div>
                            </div>
                        </div>

                        <div class="sheet-container">
                            <div class="sheet-header">
                                <div>
                                    <div class="btn-group me-2">
                                        <button class="btn btn-success btn-sm" id="addRow"><i class="fas fa-plus me-1"></i>添加行</button>
                                        <button class="btn btn-danger btn-sm" id="deleteRow"><i class="fas fa-minus me-1"></i>删除行</button>
                                    </div>
                                    <div class="btn-group me-2">
                                        <button class="btn btn-primary btn-sm" id="addColumn"><i class="fas fa-columns me-1"></i>添加列</button>
                                        <button class="btn btn-warning btn-sm" id="editHeaders"><i class="fas fa-heading me-1"></i>修改标题</button>
                                    </div>
                                    <button class="btn btn-info btn-sm me-2" id="calculate"><i class="fas fa-calculator me-1"></i>重新计算</button>
                                </div>
                                <div class="sheet-tools">
                                    <button class="btn btn-primary btn-sm" id="saveData"><i class="fas fa-save me-1"></i>保存数据</button>
                                    <button class="btn btn-outline-secondary btn-sm" id="importData"><i class="fas fa-file-import me-1"></i>导入</button>
                                    <button class="btn btn-outline-secondary btn-sm" id="exportData"><i class="fas fa-file-export me-1"></i>导出</button>
                                </div>
                            </div>

                            <div class="table-container">
                                <table class="sheet-table" id="salaryTable">
                                    <thead>
                                        <tr>
                                            <th data-type="text">员工编号 <i class="fas fa-sort"></i></th>
                                            <th data-type="text">姓名 <i class="fas fa-sort"></i></th>
                                            <th data-type="text">部门 <i class="fas fa-sort"></i></th>
                                            <th data-type="numeric">基本工资 <i class="fas fa-sort"></i></th>
                                            <th data-type="numeric">日常加班工时 <i class="fas fa-sort"></i></th>
                                            <th data-type="numeric">加班工资 <i class="fas fa-sort"></i></th>
                                            <th data-type="numeric">奖金 <i class="fas fa-sort"></i></th>
                                            <th data-type="numeric">扣款 <i class="fas fa-sort"></i></th>
                                            <th data-type="numeric">应发工资 <i class="fas fa-sort"></i></th>
                                            <th data-type="numeric">个人所得税 <i class="fas fa-sort"></i></th>
                                            <th data-type="numeric">实发工资 <i class="fas fa-sort"></i></th>
                                            <th data-type="action">操作</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="editable-cell">1001</td>
                                            <td class="editable-cell">张三</td>
                                            <td class="editable-cell">掘采三队</td>
                                            <td class="editable-cell numeric">8,000</td>
                                            <td class="editable-cell numeric">10</td>
                                            <td class="numeric">1,500</td>
                                            <td class="editable-cell numeric">1,000</td>
                                            <td class="editable-cell numeric">200</td>
                                            <td class="numeric">10,300</td>
                                            <td class="numeric">530</td>
                                            <td class="numeric">9,770</td>
                                            <td>
                                                <button class="btn btn-sm btn-primary action-btn"><i class="fas fa-edit"></i></button>
                                                <button class="btn btn-sm btn-danger action-btn"><i class="fas fa-trash"></i></button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="editable-cell">1002</td>
                                            <td class="editable-cell">李四</td>
                                            <td class="editable-cell">掘采三队</td>
                                            <td class="editable-cell numeric">7,500</td>
                                            <td class="editable-cell numeric">8</td>
                                            <td class="numeric">1,200</td>
                                            <td class="editable-cell numeric">800</td>
                                            <td class="editable-cell numeric">150</td>
                                            <td class="numeric">9,350</td>
                                            <td class="numeric">435</td>
                                            <td class="numeric">8,915</td>
                                            <td>
                                                <button class="btn btn-sm btn-primary action-btn"><i class="fas fa-edit"></i></button>
                                                <button class="btn btn-sm btn-danger action-btn"><i class="fas fa-trash"></i></button>
                                            </td>
                                        </tr>
                                        <tr class="highlight">
                                            <td class="editable-cell">1003</td>
                                            <td class="editable-cell">王五</td>
                                            <td class="editable-cell">掘采三队</td>
                                            <td class="editable-cell numeric">8,500</td>
                                            <td class="editable-cell numeric">12</td>
                                            <td class="numeric">1,800</td>
                                            <td class="editable-cell numeric">1,200</td>
                                            <td class="editable-cell numeric">300</td>
                                            <td class="numeric">11,200</td>
                                            <td class="numeric">620</td>
                                            <td class="numeric">10,580</td>
                                            <td>
                                                <button class="btn btn-sm btn-primary action-btn"><i class="fas fa-edit"></i></button>
                                                <button class="btn btn-sm btn-danger action-btn"><i class="fas fa-trash"></i></button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="editable-cell">1004</td>
                                            <td class="editable-cell">赵六</td>
                                            <td class="editable-cell">掘采三队</td>
                                            <td class="editable-cell numeric">7,200</td>
                                            <td class="editable-cell numeric">5</td>
                                            <td class="numeric">750</td>
                                            <td class="editable-cell numeric">600</td>
                                            <td class="editable-cell numeric">100</td>
                                            <td class="numeric">8,450</td>
                                            <td class="numeric">345</td>
                                            <td class="numeric">8,105</td>
                                            <td>
                                                <button class="btn btn-sm btn-primary action-btn"><i class="fas fa-edit"></i></button>
                                                <button class="btn btn-sm btn-danger action-btn"><i class="fas fa-trash"></i></button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="footer">
                            <p>© 2023 掘采三队工资管理系统 | 提示: 支持从Excel复制粘贴数据，使用Ctrl+C和Ctrl+V进行批量操作</p>
                        </div>
                    </div>
                </div>
                
                <!-- 帮助中心标签页 -->
                <div class="tab-pane fade" id="help" role="tabpanel">
                    <div class="welcome-section">
                        <i class="fas fa-question-circle fa-3x text-primary"></i>
                        <h2>帮助中心</h2>
                        <p class="text-muted">常见问题与使用指南</p>
                    </div>
                    
                    <div class="accordion" id="helpAccordion">
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#help1">
                                    如何查看我的工资条？
                                </button>
                            </h2>
                            <div id="help1" class="accordion-collapse collapse show" data-bs-parent="#helpAccordion">
                                <div class="accordion-body">
                                    使用您的员工编号和密码登录系统后，在"工资查询"标签页可以看到您的最新工资条信息。您也可以查看历史工资记录。
                                </div>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#help2">
                                    工资条上的各项含义是什么？
                                </button>
                            </h2>
                            <div id="help2" class="accordion-collapse collapse" data-bs-parent="#helpAccordion">
                                <div class="accordion-body">
                                    <ul>
                                        <li><strong>基本工资</strong>: 您的基础工资</li>
                                        <li><strong>加班工资</strong>: 根据加班工时计算的额外工资</li>
                                        <li><strong>奖金</strong>: 绩效奖金或其他奖励</li>
                                        <li><strong>扣款</strong>: 社保、公积金或其他扣款项目</li>
                                        <li><strong>个人所得税</strong>: 根据国家规定计算的个人所得税</li>
                                        <li><strong>实发工资</strong>: 您实际收到的工资金额</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#help3">
                                    如果发现工资有误怎么办？
                                </button>
                            </h2>
                            <div id="help3" class="accordion-collapse collapse" data-bs-parent="#helpAccordion">
                                <div class="accordion-body">
                                    如果您发现工资条信息有误，请及时联系掘采三队人力资源部门或您的直属主管。
                                </div>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#help4">
                                    忘记密码怎么办？
                                </button>
                            </h2>
                            <div id="help4" class="accordion-collapse collapse" data-bs-parent="#helpAccordion">
                                <div class="accordion-body">
                                    如果您忘记了密码，请联系管理员重置密码。初始密码为123，建议首次登录后修改密码。
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // 模拟数据库 - 员工信息和密码
        const employees = {
            "1001": { name: "张三", department: "掘采三队", password: "123", role: "employee" },
            "1002": { name: "李四", department: "掘采三队", password: "123", role: "employee" },
            "1003": { name: "王五", department: "掘采三队", password: "123", role: "employee" },
            "1004": { name: "赵六", department: "掘采三队", password: "123", role: "employee" },
            "admin": { name: "管理员", department: "掘采三队", password: "123", role: "admin" }
        };

        // 模拟工资数据
        const salaryData = {
            "1001": {
                basic: 8000,
                otHours: 10,
                otSalary: 1500,
                bonus: 1000,
                deduction: 200,
                tax: 530,
                net: 9770
            },
            "1002": {
                basic: 7500,
                otHours: 8,
                otSalary: 1200,
                bonus: 800,
                deduction: 150,
                tax: 435,
                net: 8915
            },
            "1003": {
                basic: 8500,
                otHours: 12,
                otSalary: 1800,
                bonus: 1200,
                deduction: 300,
                tax: 620,
                net: 10580
            },
            "1004": {
                basic: 7200,
                otHours: 5,
                otSalary: 750,
                bonus: 600,
                deduction: 100,
                tax: 345,
                net: 8105
            }
        };

        document.addEventListener('DOMContentLoaded', function() {
            // 登录功能
            document.getElementById('loginBtn').addEventListener('click', function() {
                const employeeId = document.getElementById('employeeId').value;
                const password = document.getElementById('password').value;
                
                if (!employeeId || !password) {
                    alert('请输入员工编号和密码');
                    return;
                }
                
                // 验证员工编号和密码
                if (employees[employeeId] && employees[employeeId].password === password) {
                    document.getElementById('loginPage').classList.add('d-none');
                    document.getElementById('platformPage').classList.remove('d-none');
                    
                    // 设置用户信息
                    const user = employees[employeeId];
                    document.getElementById('userName').textContent = user.name;
                    
                    if (user.role === 'admin') {
                        document.body.classList.add('role-admin');
                        document.getElementById('userRoleBadge').textContent = '管理员';
                    } else {
                        document.getElementById('userRoleBadge').textContent = '员工';
                        
                        // 更新工资信息
                        if (salaryData[employeeId]) {
                            const salary = salaryData[employeeId];
                            document.getElementById('currentEmployeeId').textContent = employeeId;
                            document.getElementById('currentEmployeeName').textContent = user.name;
                            document.getElementById('currentEmployeeDept').textContent = user.department;
                            document.getElementById('welcomeMessage').textContent = `${user.name}，您好！您可以在这里查询您的工资明细和历史记录`;
                        }
                    }
                    
                } else {
                    alert('员工编号或密码错误，请重试');
                }
            });
            
            // 退出功能
            document.getElementById('logoutBtn').addEventListener('click', function() {
                document.getElementById('loginPage').classList.remove('d-none');
                document.getElementById('platformPage').classList.add('d-none');
                document.body.classList.remove('role-admin');
                document.getElementById('employeeId').value = '';
                document.getElementById('password').value = '';
            });
            
            // 密码管理功能
            document.getElementById('searchEmployeeBtn').addEventListener('click', function() {
                const employeeId = document.getElementById('passwordEmployeeId').value;
                if (employees[employeeId]) {
                    alert(`找到员工: ${employees[employeeId].name}，当前密码为: ${employees[employeeId].password}`);
                } else {
                    alert('未找到该员工编号');
                }
            });
            
            document.getElementById('changePasswordBtn').addEventListener('click', function() {
                const employeeId = document.getElementById('passwordEmployeeId').value;
                const newPassword = document.getElementById('newPassword').value;
                
                if (!employeeId || !newPassword) {
                    alert('请输入员工编号和新密码');
                    return;
                }
                
                if (employees[employeeId]) {
                    employees[employeeId].password = newPassword;
                    alert(`员工 ${employees[employeeId].name} 的密码已更新为: ${newPassword}`);
                    document.getElementById('passwordEmployeeId').value = '';
                    document.getElementById('newPassword').value = '';
                } else {
                    alert('未找到该员工编号');
                }
            });
            
            // 管理员后台功能
            const table = document.getElementById('salaryTable');
            let selectedCell = null;
            let isEditingHeaders = false;
            
            if (table) {
                // 单元格点击选择
                table.addEventListener('click', function(e) {
                    const cell = e.target.closest('td');
                    const th = e.target.closest('th');
                    
                    if (isEditingHeaders && th && !th.querySelector('input')) {
                        const text = th.innerText;
                        th.innerHTML = `<input type="text" value="${text}" class="form-control">`;
                        th.querySelector('input').focus();
                        return;
                    }
                    
                    if (!cell) return;
                    
                    // 清除之前的选择
                    if (selectedCell) {
                        selectedCell.classList.remove('selected-cell');
                    }
                    
                    // 选择新单元格
                    cell.classList.add('selected-cell');
                    selectedCell = cell;
                    
                    // 如果是可编辑单元格，聚焦
                    if (cell.classList.contains('editable-cell') && !cell.querySelector('input')) {
                        const text = cell.innerText;
                        cell.innerHTML = `<input type="text" value="${text}" class="form-control">`;
                        cell.querySelector('input').focus();
                    }
                });
                
                // 输入框失去焦点时保存内容
                table.addEventListener('blur', function(e) {
                    const input = e.target;
                    if (input.tagName === 'INPUT') {
                        const cell = input.closest('td');
                        const th = input.closest('th');
                        
                        if (cell) {
                            cell.innerText = input.value;
                            cell.classList.add('selected-cell');
                            
                            // 触发重新计算
                            calculateRow(cell.closest('tr'));
                        }
                        
                        if (th) {
                            th.innerHTML = input.value + ' <i class="fas fa-sort"></i>';
                            isEditingHeaders = false;
                        }
                    }
                }, true);
                
                // 按回车键移动到下一个单元格
                table.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' && e.target.tagName === 'INPUT') {
                        e.preventDefault();
                        e.target.blur();
                        
                        // 找到下一个单元格
                        const cell = e.target.closest('td');
                        const th = e.target.closest('th');
                        
                        if (cell) {
                            const row = cell.parentElement;
                            let nextCell = cell.nextElementSibling;
                            
                            if (!nextCell) {
                                const nextRow = row.nextElementSibling;
                                if (nextRow) {
                                    nextCell = nextRow.firstElementChild;
                                }
                            }
                            
                            if (nextCell) {
                                nextCell.click();
                            }
                        }
                        
                        if (th) {
                            const nextTh = th.nextElementSibling;
                            if (nextTh) {
                                nextTh.click();
                            }
                        }
                    }
                });
                
                // 添加新行
                document.getElementById('addRow').addEventListener('click', function() {
                    const tbody = table.querySelector('tbody');
                    const newRow = document.createElement('tr');
                    newRow.innerHTML = `
                        <td class="editable-cell">${1000 + tbody.children.length + 1}</td>
                        <td class="editable-cell"></td>
                        <td class="editable-cell">掘采三队</td>
                        <td class="editable-cell numeric"></td>
                        <td class="editable-cell numeric"></td>
                        <td class="numeric">0</td>
                        <td class="editable-cell numeric"></td>
                        <td class="editable-cell numeric"></td>
                        <td class="numeric">0</td>
                        <td class="numeric">0</td>
                        <td class="numeric">0</td>
                        <td>
                            <button class="btn btn-sm btn-primary action-btn"><i class="fas fa-edit"></i></button>
                            <button class="btn btn-sm btn-danger action-btn"><i class="fas fa-trash"></i></button>
                        </td>
                    `;
                    tbody.appendChild(newRow);
                });
                
                // 删除选中行
                document.getElementById('deleteRow').addEventListener('click', function() {
                    if (selectedCell) {
                        const row = selectedCell.closest('tr');
                        if (row && row.parentElement.tagName === 'TBODY') {
                            row.remove();
                        }
                    } else {
                        alert('请先选择要删除的行中的一个单元格');
                    }
                });
                
                // 添加新列
                document.getElementById('addColumn').addEventListener('click', function() {
                    const colName = prompt('请输入新列的名称：', '新列');
                    if (!colName) return;
                    
                    // 添加表头
                    const headerRow = table.querySelector('thead tr');
                    const newHeader = document.createElement('th');
                    newHeader.innerHTML = colName + ' <i class="fas fa-sort"></i>';
                    newHeader.setAttribute('data-type', 'text');
                    headerRow.insertBefore(newHeader, headerRow.lastElementChild);
                    
                    // 为每一行添加单元格
                    const rows = table.querySelectorAll('tbody tr');
                    rows.forEach(row => {
                        const newCell = document.createElement('td');
                        newCell.className = 'editable-cell';
                        row.insertBefore(newCell, row.lastElementChild);
                    });
                });
                
                // 修改标题
                document.getElementById('editHeaders').addEventListener('click', function() {
                    isEditingHeaders = !isEditingHeaders;
                    this.classList.toggle('btn-warning');
                    this.classList.toggle('btn-success');
                    
                    if (isEditingHeaders) {
                        this.innerHTML = '<i class="fas fa-check me-1"></i>完成编辑';
                        alert('现在您可以点击表头修改列名称');
                    } else {
                        this.innerHTML = '<i class="fas fa-heading me-1"></i>修改标题';
                    }
                });
                
                // 重新计算所有行
                document.getElementById('calculate').addEventListener('click', function() {
                    const rows = table.querySelectorAll('tbody tr');
                    rows.forEach(row => calculateRow(row));
                    alert('所有数据已重新计算！');
                });
                
                // 计算单行数据
                function calculateRow(row) {
                    const cells = row.querySelectorAll('td');
                    if (cells.length < 11) return;
                    
                    const basicSalary = parseFloat(cells[3].innerText.replace(/,/g, '')) || 0;
                    const otHours = parseFloat(cells[4].innerText.replace(/,/g, '')) || 0;
                    const bonus = parseFloat(cells[6].innerText.replace(/,/g, '')) || 0;
                    const deduction = parseFloat(cells[7].innerText.replace(/,/g, '')) || 0;
                    
                    // 计算加班工资 (假设每小时加班工资为基本工资/21.75/8 * 1.5)
                    const otRate = (basicSalary / 21.75 / 8) * 1.5;
                    const otSalary = otHours * otRate;
                    
                    // 计算应发工资
                    const grossSalary = basicSalary + otSalary + bonus - deduction;
                    
                    // 计算个人所得税 (简化计算)
                    let tax = 0;
                    if (grossSalary > 5000) {
                        tax = (grossSalary - 5000) * 0.1;
                    }
                    
                    // 计算实发工资
                    const netSalary = grossSalary - tax;
                    
                    // 更新单元格
                    cells[5].innerText = otSalary.toLocaleString('zh-CN', {maximumFractionDigits: 2});
                    cells[8].innerText = grossSalary.toLocaleString('zh-CN', {maximumFractionDigits: 2});
                    cells[9].innerText = tax.toLocaleString('zh-CN', {maximumFractionDigits: 2});
                    cells[10].innerText = netSalary.toLocaleString('zh-CN', {maximumFractionDigits: 2});
                }
                
                // 初始化计算所有行
                document.querySelectorAll('#salaryTable tbody tr').forEach(row => {
                    calculateRow(row);
                });
                
                // 保存数据
                document.getElementById('saveData').addEventListener('click', function() {
                    this.innerHTML = '<i class="fas fa-spinner fa-spin me-1"></i>保存中...';
                    setTimeout(() => {
                        this.innerHTML = '<i class="fas fa-save me-1"></i>保存数据';
                        alert('数据保存成功！');
                    }, 1000);
                });
                
                // 模拟导入功能
                document.getElementById('importData').addEventListener('click', function() {
                    alert('支持从Excel复制数据，然后直接粘贴到表格中');
                });
                
                // 模拟导出功能
                document.getElementById('exportData').addEventListener('click', function() {
                    alert('导出功能已触发，数据正在准备下载...');
                });
                
                // 表头排序功能
                document.querySelectorAll('th').forEach(th => {
                    th.addEventListener('click', function() {
                        if (isEditingHeaders) return;
                        
                        const index = Array.from(this.parentElement.children).indexOf(this);
                        const type = this.getAttribute('data-type');
                        const tbody = table.querySelector('tbody');
                        const rows = Array.from(tbody.querySelectorAll('tr'));
                        
                        // 切换排序方向
                        const isAscending = this.classList.toggle('asc');
                        this.classList.toggle('desc', !isAscending);
                        
                        // 排序行
                        rows.sort((a, b) => {
                            let aValue = a.children[index].innerText;
                            let bValue = b.children[index].innerText;
                            
                            if (type === 'numeric') {
                                aValue = parseFloat(aValue.replace(/,/g, '')) || 0;
                                bValue = parseFloat(bValue.replace(/,/g, '')) || 0;
                            }
                            
                            if (aValue < bValue) return isAscending ? -1 : 1;
                            if (aValue > bValue) return isAscending ? 1 : -1;
                            return 0;
                        });
                        
                        // 重新添加行
                        rows.forEach(row => tbody.appendChild(row));
                    });
                });
            }
        });
    </script>
</body>
</html>